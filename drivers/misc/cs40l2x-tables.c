// SPDX-License-Identifier: GPL-2.0
//
// CS40L20/CS40L25/CS40L25A/CS40L25B Haptics Driver
//
// Copyright (C) 2018-2020 Cirrus Logic, Inc.

#include <linux/mfd/cs40l2x.h>

const unsigned char cs40l2x_bst_k1_table[4][5] = {
	{0x24, 0x32, 0x32, 0x4F, 0x57},
	{0x24, 0x32, 0x32, 0x4F, 0x57},
	{0x40, 0x32, 0x32, 0x4F, 0x57},
	{0x40, 0x32, 0x32, 0x4F, 0x57}
};

const unsigned char cs40l2x_bst_k2_table[4][5] = {
	{0x24, 0x49, 0x66, 0xA3, 0xEA},
	{0x24, 0x49, 0x66, 0xA3, 0xEA},
	{0x48, 0x49, 0x66, 0xA3, 0xEA},
	{0x48, 0x49, 0x66, 0xA3, 0xEA}
};

const unsigned char cs40l2x_bst_slope_table[4] = {0x75, 0x6B, 0x3B, 0x28};

bool cs40l2x_readable_reg(struct device *dev, unsigned int reg)
{
	switch (reg) {
	case CS40L2X_DEVID:
	case CS40L2X_REVID:
	case CS40L2X_OTPID:
	case CS40L2X_TEST_KEY_CTL:
	case CS40L2X_GLOBAL_ENABLES:
	case CS40L2X_BLOCK_ENABLES:
	case CS40L2X_BLOCK_ENABLES2:
	case CS40L2X_GLOBAL_OVERRIDES:
	case CS40L2X_GLOBAL_SYNC:
	case CS40L2X_ERROR_RELEASE:
	case CS40L2X_LRCK_PAD_CONTROL:
	case CS40L2X_SDIN_PAD_CONTROL:
	case CS40L2X_GPIO_PAD_CONTROL:
	case CS40L2X_PWRMGT_CTL:
	case CS40L2X_WAKESRC_CTL:
	case CS40L2X_PWRMGT_STS:
	case CS40L2X_REFCLK_INPUT:
	case CS40L2X_GLOBAL_SAMPLE_RATE:
	case CS40L2X_FS_MON_0:
	case CS40L2X_VBST_CTL_1:
	case CS40L2X_VBST_CTL_2:
	case CS40L2X_BST_IPK_CTL:
	case CS40L2X_SOFT_RAMP:
	case CS40L2X_BST_LOOP_COEFF:
	case CS40L2X_LBST_SLOPE:
	case CS40L2X_BST_SW_FREQ:
	case CS40L2X_BST_DCM_CTL:
	case CS40L2X_DCM_FORCE:
	case CS40L2X_VBST_OVP:
	case CS40L2X_TEST_LBST:
	case CS40L2X_WARM_LIMIT_THRESHOLD:
	case CS40L2X_CONFIGURATION:
	case CS40L2X_ENABLES_AND_CODES_DIG:
	case CS40L2X_ASP_ENABLES1:
	case CS40L2X_ASP_CONTROL1:
	case CS40L2X_ASP_CONTROL2:
	case CS40L2X_ASP_CONTROL3:
	case CS40L2X_ASP_FRAME_CONTROL5:
	case CS40L2X_ASP_DATA_CONTROL5:
	case CS40L2X_DACPCM1_INPUT:
	case CS40L2X_DSP1RX1_INPUT:
	case CS40L2X_DSP1RX2_INPUT:
	case CS40L2X_DSP1RX3_INPUT:
	case CS40L2X_DSP1RX4_INPUT:
	case CS40L2X_DSP1RX5_INPUT:
	case CS40L2X_DSP1RX6_INPUT:
	case CS40L2X_DSP1RX7_INPUT:
	case CS40L2X_DSP1RX8_INPUT:
	case CS40L2X_NGATE1_INPUT:
	case CS40L2X_NGATE2_INPUT:
	case CS40L2X_AMP_CTRL:
	case CS40L2X_VPBR_CONFIG:
	case CS40L2X_VBBR_CONFIG:
	case CS40L2X_VPBR_STATUS:
	case CS40L2X_VBBR_STATUS:
	case CS40L2X_OTW_CONFIG:
	case CS40L2X_AMP_ERROR_VOL_SEL:
	case CS40L2X_VOL_STATUS_TO_DSP:
	case CS40L2X_CLASSH_CONFIG:
	case CS40L2X_WKFET_AMP_CONFIG:
	case CS40L2X_NG_CONFIG:
	case CS40L2X_AMP_GAIN:
	case CS40L2X_SPK_FORCE_TST_1:
	case CS40L2X_IRQ1_CFG:
	case CS40L2X_IRQ1_STATUS:
	case CS40L2X_IRQ1_EINT_1:
	case CS40L2X_IRQ1_EINT_2:
	case CS40L2X_IRQ1_EINT_3:
	case CS40L2X_IRQ1_EINT_4:
	case CS40L2X_IRQ1_STS_1:
	case CS40L2X_IRQ1_STS_2:
	case CS40L2X_IRQ1_STS_3:
	case CS40L2X_IRQ1_STS_4:
	case CS40L2X_IRQ1_MASK_1:
	case CS40L2X_IRQ1_MASK_2:
	case CS40L2X_IRQ1_MASK_3:
	case CS40L2X_IRQ1_MASK_4:
	case CS40L2X_IRQ1_EDGE_1:
	case CS40L2X_IRQ1_EDGE_4:
	case CS40L2X_IRQ1_POL_1:
	case CS40L2X_IRQ1_POL_4:
	case CS40L2X_IRQ1_DB_3:
	case CS40L2X_IRQ2_CFG:
	case CS40L2X_IRQ2_STATUS:
	case CS40L2X_IRQ2_EINT_1:
	case CS40L2X_IRQ2_EINT_2:
	case CS40L2X_IRQ2_EINT_3:
	case CS40L2X_IRQ2_EINT_4:
	case CS40L2X_IRQ2_STS_1:
	case CS40L2X_IRQ2_STS_2:
	case CS40L2X_IRQ2_STS_3:
	case CS40L2X_IRQ2_STS_4:
	case CS40L2X_IRQ2_MASK_1:
	case CS40L2X_IRQ2_MASK_2:
	case CS40L2X_IRQ2_MASK_3:
	case CS40L2X_IRQ2_MASK_4:
	case CS40L2X_IRQ2_EDGE_1:
	case CS40L2X_IRQ2_EDGE_4:
	case CS40L2X_IRQ2_POL_1:
	case CS40L2X_IRQ2_POL_4:
	case CS40L2X_IRQ2_DB_3:
	case CS40L2X_GPIO_STATUS1:
	case CS40L2X_GPIO1_CTRL1:
	case CS40L2X_GPIO2_CTRL1:
	case CS40L2X_GPIO3_CTRL1:
	case CS40L2X_GPIO4_CTRL1:
	case CS40L2X_CLOCK_DETECT_1:
	case CS40L2X_DSP1_AHBM_WINDOW_DEBUG_0:
	case CS40L2X_DSP1_AHBM_WINDOW_DEBUG_1:
	case CS40L2X_DSP1_SAMPLE_RATE_RX1:
	case CS40L2X_DSP1_SAMPLE_RATE_RX2:
	case CS40L2X_DSP1_SAMPLE_RATE_RX3:
	case CS40L2X_DSP1_SAMPLE_RATE_RX4:
	case CS40L2X_DSP1_SAMPLE_RATE_RX5:
	case CS40L2X_DSP1_SAMPLE_RATE_RX6:
	case CS40L2X_DSP1_SAMPLE_RATE_RX7:
	case CS40L2X_DSP1_SAMPLE_RATE_RX8:
	case CS40L2X_DSP1_SAMPLE_RATE_TX1:
	case CS40L2X_DSP1_SAMPLE_RATE_TX2:
	case CS40L2X_DSP1_SAMPLE_RATE_TX3:
	case CS40L2X_DSP1_SAMPLE_RATE_TX4:
	case CS40L2X_DSP1_SAMPLE_RATE_TX5:
	case CS40L2X_DSP1_SAMPLE_RATE_TX6:
	case CS40L2X_DSP1_SAMPLE_RATE_TX7:
	case CS40L2X_DSP1_SAMPLE_RATE_TX8:
	case CS40L2X_DSP1_SCRATCH1:
	case CS40L2X_DSP1_SCRATCH2:
	case CS40L2X_DSP1_SCRATCH3:
	case CS40L2X_DSP1_SCRATCH4:
	case CS40L2X_DSP1_CCM_CORE_CONTROL:
	case CS40L2X_DSP1_MPU_XM_ACCESS_0:
	case CS40L2X_DSP1_MPU_YM_ACCESS_0:
	case CS40L2X_DSP1_MPU_WINDOW_ACCESS_0:
	case CS40L2X_DSP1_MPU_XREG_ACCESS_0:
	case CS40L2X_DSP1_MPU_YREG_ACCESS_0:
	case CS40L2X_DSP1_MPU_XM_ACCESS_1:
	case CS40L2X_DSP1_MPU_YM_ACCESS_1:
	case CS40L2X_DSP1_MPU_WINDOW_ACCESS_1:
	case CS40L2X_DSP1_MPU_XREG_ACCESS_1:
	case CS40L2X_DSP1_MPU_YREG_ACCESS_1:
	case CS40L2X_DSP1_MPU_XM_ACCESS_2:
	case CS40L2X_DSP1_MPU_YM_ACCESS_2:
	case CS40L2X_DSP1_MPU_WINDOW_ACCESS_2:
	case CS40L2X_DSP1_MPU_XREG_ACCESS_2:
	case CS40L2X_DSP1_MPU_YREG_ACCESS_2:
	case CS40L2X_DSP1_MPU_XM_ACCESS_3:
	case CS40L2X_DSP1_MPU_YM_ACCESS_3:
	case CS40L2X_DSP1_MPU_WINDOW_ACCESS_3:
	case CS40L2X_DSP1_MPU_XREG_ACCESS_3:
	case CS40L2X_DSP1_MPU_YREG_ACCESS_3:
	case CS40L2X_DSP1_MPU_XM_VIO_ADDR:
	case CS40L2X_DSP1_MPU_XM_VIO_STATUS:
	case CS40L2X_DSP1_MPU_YM_VIO_ADDR:
	case CS40L2X_DSP1_MPU_YM_VIO_STATUS:
	case CS40L2X_DSP1_MPU_PM_VIO_ADDR:
	case CS40L2X_DSP1_MPU_PM_VIO_STATUS:
	case CS40L2X_DSP1_MPU_LOCK_CONFIG:
	case CS40L2X_OTP_TRIM_1:
	case CS40L2X_OTP_TRIM_2:
	case CS40L2X_OTP_TRIM_3:
	case CS40L2X_OTP_TRIM_4:
	case CS40L2X_OTP_TRIM_5:
	case CS40L2X_OTP_TRIM_6:
	case CS40L2X_OTP_TRIM_7:
	case CS40L2X_OTP_TRIM_8:
	case CS40L2X_OTP_TRIM_9:
	case CS40L2X_OTP_TRIM_10:
	case CS40L2X_OTP_TRIM_11:
	case CS40L2X_OTP_TRIM_12:
	case CS40L2X_OTP_TRIM_13:
	case CS40L2X_OTP_TRIM_14:
	case CS40L2X_OTP_TRIM_15:
	case CS40L2X_OTP_TRIM_16:
	case CS40L2X_OTP_TRIM_17:
	case CS40L2X_OTP_TRIM_18:
	case CS40L2X_OTP_TRIM_19:
	case CS40L2X_OTP_TRIM_20:
	case CS40L2X_OTP_TRIM_21:
	case CS40L2X_OTP_TRIM_22:
	case CS40L2X_OTP_TRIM_23:
	case CS40L2X_OTP_TRIM_24:
	case CS40L2X_OTP_TRIM_25:
	case CS40L2X_OTP_TRIM_26:
	case CS40L2X_OTP_TRIM_27:
	case CS40L2X_OTP_TRIM_28:
	case CS40L2X_OTP_TRIM_29:
	case CS40L2X_OTP_TRIM_30:
	case CS40L2X_OTP_TRIM_31:
	case CS40L2X_OTP_TRIM_32:
	case CS40L2X_OTP_TRIM_33:
	case CS40L2X_OTP_TRIM_34:
	case CS40L2X_OTP_TRIM_35:
	case CS40L2X_OTP_TRIM_36:
	case CS40L2X_OTP_MEM0 ... CS40L2X_OTP_MEM31:
	case CS40L2X_DSP_VIRTUAL1_MBOX_1 ... CS40L2X_DSP_VIRTUAL1_MBOX_8:
	case CS40L2X_DSP1_XMEM_PACK_0 ... CS40L2X_DSP1_XMEM_PACK_3068:
	case CS40L2X_DSP1_XMEM_UNPACK24_0 ... CS40L2X_DSP1_XMEM_UNPACK24_4093:
	case CS40L2X_DSP1_YMEM_PACK_0 ... CS40L2X_DSP1_YMEM_PACK_1532:
	case CS40L2X_DSP1_YMEM_UNPACK24_0 ... CS40L2X_DSP1_YMEM_UNPACK24_2045:
	case CS40L2X_DSP1_PMEM_0 ... CS40L2X_DSP1_PMEM_5114:
		return true;
	default:
		return false;
	}
}

bool cs40l2x_precious_reg(struct device *dev, unsigned int reg)
{
	switch (reg) {
	case CS40L2X_OTP_MEM0 ... CS40L2X_OTP_MEM31:
	case CS40L2X_DSP1_XMEM_PACK_0 ... CS40L2X_DSP1_XMEM_PACK_3068:
	case CS40L2X_DSP1_YMEM_PACK_0 ... CS40L2X_DSP1_YMEM_PACK_1532:
	case CS40L2X_DSP1_PMEM_0 ... CS40L2X_DSP1_PMEM_5114:
		return true;
	default:
		return false;
	}
}

static const struct cs40l2x_trim cs40l2x_trim_table_c[] = {
	/* addr         shift   size */
	{0x00002030,	0,	4}, /*TRIM_OSC_FREQ_TRIM*/
	{0x00002030,	7,	1}, /*TRIM_OSC_TRIM_DONE*/
	{0x0000208C,	24,	6}, /*TST_DIGREG_VREF_TRIM*/
	{0x00002090,	14,	4}, /*TST_REF_TRIM*/
	{0x00002090,	10,	4}, /*TST_REF_TEMPCO_TRIM*/
	{0x0000300C,	11,	4}, /*PLL_LDOA_TST_VREF_TRIM*/
	{0x0000394C,	23,	2}, /*BST_ATEST_CM_VOFF*/
	{0x00003950,	0,	7}, /*BST_ATRIM_IADC_OFFSET*/
	{0x00003950,	8,	7}, /*BST_ATRIM_IADC_GAIN1*/
	{0x00003950,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET1*/
	{0x00003950,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN1*/
	{0x00003954,	0,	7}, /*BST_ATRIM_IADC_OFFSET2*/
	{0x00003954,	8,	7}, /*BST_ATRIM_IADC_GAIN2*/
	{0x00003954,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET2*/
	{0x00003954,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN2*/
	{0x00003958,	0,	7}, /*BST_ATRIM_IADC_OFFSET3*/
	{0x00003958,	8,	7}, /*BST_ATRIM_IADC_GAIN3*/
	{0x00003958,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET3*/
	{0x00003958,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN3*/
	{0x0000395C,	0,	7}, /*BST_ATRIM_IADC_OFFSET4*/
	{0x0000395C,	8,	7}, /*BST_ATRIM_IADC_GAIN4*/
	{0x0000395C,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET4*/
	{0x0000395C,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN4*/
	{0x0000416C,	0,	8}, /*VMON_GAIN_OTP_VAL*/
	{0x00004160,	0,	7}, /*VMON_OFFSET_OTP_VAL*/
	{0x0000416C,	8,	8}, /*IMON_GAIN_OTP_VAL*/
	{0x00004160,	16,	10}, /*IMON_OFFSET_OTP_VAL*/
	{0x0000416C,	16,	12}, /*VMON_CM_GAIN_OTP_VAL*/
	{0x0000416C,	28,	1}, /*VMON_CM_GAIN_SIGN_OTP_VAL*/
	{0x00004170,	0,	6}, /*IMON_CAL_TEMPCO_OTP_VAL*/
	{0x00004170,	6,	1}, /*IMON_CAL_TEMPCO_SIGN_OTP*/
	{0x00004170,	8,	6}, /*IMON_CAL_TEMPCO2_OTP_VAL*/
	{0x00004170,	14,	1}, /*IMON_CAL_TEMPCO2_DN_UPB_OTP_VAL*/
	{0x00004170,	16,	9}, /*IMON_CAL_TEMPCO_TBASE_OTP_VAL*/
	{0x00004360,	0,	5}, /*TEMP_GAIN_OTP_VAL*/
	{0x00004360,	6,	9}, /*TEMP_OFFSET_OTP_VAL*/
	{0x00004448,	0,	8}, /*VP_SARADC_OFFSET*/
	{0x00004448,	8,	8}, /*VP_GAIN_INDEX*/
	{0x00004448,	16,	8}, /*VBST_SARADC_OFFSET*/
	{0x00004448,	24,	8}, /*VBST_GAIN_INDEX*/
	{0x0000444C,	0,	3}, /*ANA_SELINVREF*/
	{0x00006E30,	0,	5}, /*GAIN_ERR_COEFF_0*/
	{0x00006E30,	8,	5}, /*GAIN_ERR_COEFF_1*/
	{0x00006E30,	16,	5}, /*GAIN_ERR_COEFF_2*/
	{0x00006E30,	24,	5}, /*GAIN_ERR_COEFF_3*/
	{0x00006E34,	0,	5}, /*GAIN_ERR_COEFF_4*/
	{0x00006E34,	8,	5}, /*GAIN_ERR_COEFF_5*/
	{0x00006E34,	16,	5}, /*GAIN_ERR_COEFF_6*/
	{0x00006E34,	24,	5}, /*GAIN_ERR_COEFF_7*/
	{0x00006E38,	0,	5}, /*GAIN_ERR_COEFF_8*/
	{0x00006E38,	8,	5}, /*GAIN_ERR_COEFF_9*/
	{0x00006E38,	16,	5}, /*GAIN_ERR_COEFF_10*/
	{0x00006E38,	24,	5}, /*GAIN_ERR_COEFF_11*/
	{0x00006E3C,	0,	5}, /*GAIN_ERR_COEFF_12*/
	{0x00006E3C,	8,	5}, /*GAIN_ERR_COEFF_13*/
	{0x00006E3C,	16,	5}, /*GAIN_ERR_COEFF_14*/
	{0x00006E3C,	24,	5}, /*GAIN_ERR_COEFF_15*/
	{0x00006E40,	0,	5}, /*GAIN_ERR_COEFF_16*/
	{0x00006E40,	8,	5}, /*GAIN_ERR_COEFF_17*/
	{0x00006E40,	16,	5}, /*GAIN_ERR_COEFF_18*/
	{0x00006E40,	24,	5}, /*GAIN_ERR_COEFF_19*/
	{0x00006E44,	0,	5}, /*GAIN_ERR_COEFF_20*/
	{0x00006E48,	0,	10}, /*VOFF_GAIN_0*/
	{0x00006E48,	10,	10}, /*VOFF_GAIN_1*/
	{0x00006E48,	20,	10}, /*VOFF_GAIN_2*/
	{0x00006E4C,	0,	10}, /*VOFF_GAIN_3*/
	{0x00006E4C,	10,	10}, /*VOFF_GAIN_4*/
	{0x00006E4C,	20,	10}, /*VOFF_GAIN_5*/
	{0x00006E50,	0,	10}, /*VOFF_GAIN_6*/
	{0x00006E50,	10,	10}, /*VOFF_GAIN_7*/
	{0x00006E50,	20,	10}, /*VOFF_GAIN_8*/
	{0x00006E54,	0,	10}, /*VOFF_GAIN_9*/
	{0x00006E54,	10,	10}, /*VOFF_GAIN_10*/
	{0x00006E54,	20,	10}, /*VOFF_GAIN_11*/
	{0x00006E58,	0,	10}, /*VOFF_GAIN_12*/
	{0x00006E58,	10,	10}, /*VOFF_GAIN_13*/
	{0x00006E58,	20,	10}, /*VOFF_GAIN_14*/
	{0x00006E5C,	0,	10}, /*VOFF_GAIN_15*/
	{0x00006E5C,	10,	10}, /*VOFF_GAIN_16*/
	{0x00006E5C,	20,	10}, /*VOFF_GAIN_17*/
	{0x00006E60,	0,	10}, /*VOFF_GAIN_18*/
	{0x00006E60,	10,	10}, /*VOFF_GAIN_19*/
	{0x00006E60,	20,	10}, /*VOFF_GAIN_20*/
	{0x00006E64,	0,	10}, /*VOFF_INT1*/
	{0x00007418,	7,	5}, /*DS_SPK_INT1_CAP_TRIM*/
	{0x0000741C,	0,	5}, /*DS_SPK_INT2_CAP_TRIM*/
	{0x0000741C,	11,	4}, /*DS_SPK_LPF_CAP_TRIM*/
	{0x0000741C,	19,	4}, /*DS_SPK_QUAN_CAP_TRIM*/
	{0x00007434,	17,	1}, /*FORCE_CAL*/
	{0x00007434,	18,	7}, /*CAL_OVERRIDE*/
	{0x00007068,	0,	9}, /*MODIX*/
	{0x0000410C,	7,	1}, /*VIMON_DLY_NOT_COMB*/
	{0x0000400C,	0,	7}, /*VIMON_DLY*/
	{0x00000000,	0,	1}, /*extra bit*/
	{0x00017040,	0,	8}, /*X_COORDINATE*/
	{0x00017040,	8,	8}, /*Y_COORDINATE*/
	{0x00017040,	16,	8}, /*WAFER_ID*/
	{0x00017040,	24,	8}, /*DVS*/
	{0x00017044,	0,	24}, /*LOT_NUMBER*/
};

static const struct cs40l2x_trim cs40l2x_trim_table_d[] = {
	/* addr         shift   size */
	{0x00002030,	0,	4}, /*TRIM_OSC_FREQ_TRIM*/
	{0x00002030,	7,	1}, /*TRIM_OSC_TRIM_DONE*/
	{0x0000208C,	24,	6}, /*TST_DIGREG_VREF_TRIM*/
	{0x00002090,	14,	4}, /*TST_REF_TRIM*/
	{0x00002090,	10,	4}, /*TST_REF_TEMPCO_TRIM*/
	{0x0000300C,	11,	4}, /*PLL_LDOA_TST_VREF_TRIM*/
	{0x0000394C,	23,	2}, /*BST_ATEST_CM_VOFF*/
	{0x00003950,	0,	7}, /*BST_ATRIM_IADC_OFFSET*/
	{0x00003950,	8,	7}, /*BST_ATRIM_IADC_GAIN1*/
	{0x00003950,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET1*/
	{0x00003950,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN1*/
	{0x00003954,	0,	7}, /*BST_ATRIM_IADC_OFFSET2*/
	{0x00003954,	8,	7}, /*BST_ATRIM_IADC_GAIN2*/
	{0x00003954,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET2*/
	{0x00003954,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN2*/
	{0x00003958,	0,	7}, /*BST_ATRIM_IADC_OFFSET3*/
	{0x00003958,	8,	7}, /*BST_ATRIM_IADC_GAIN3*/
	{0x00003958,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET3*/
	{0x00003958,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN3*/
	{0x0000395C,	0,	7}, /*BST_ATRIM_IADC_OFFSET4*/
	{0x0000395C,	8,	7}, /*BST_ATRIM_IADC_GAIN4*/
	{0x0000395C,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET4*/
	{0x0000395C,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN4*/
	{0x0000416C,	0,	8}, /*VMON_GAIN_OTP_VAL*/
	{0x00004160,	0,	7}, /*VMON_OFFSET_OTP_VAL*/
	{0x0000416C,	8,	8}, /*IMON_GAIN_OTP_VAL*/
	{0x00004160,	16,	10}, /*IMON_OFFSET_OTP_VAL*/
	{0x0000416C,	16,	12}, /*VMON_CM_GAIN_OTP_VAL*/
	{0x0000416C,	28,	1}, /*VMON_CM_GAIN_SIGN_OTP_VAL*/
	{0x00004170,	0,	6}, /*IMON_CAL_TEMPCO_OTP_VAL*/
	{0x00004170,	6,	1}, /*IMON_CAL_TEMPCO_SIGN_OTP*/
	{0x00004170,	8,	6}, /*IMON_CAL_TEMPCO2_OTP_VAL*/
	{0x00004170,	14,	1}, /*IMON_CAL_TEMPCO2_DN_UPB_OTP_VAL*/
	{0x00004170,	16,	9}, /*IMON_CAL_TEMPCO_TBASE_OTP_VAL*/
	{0x00004360,	0,	5}, /*TEMP_GAIN_OTP_VAL*/
	{0x00004360,	6,	9}, /*TEMP_OFFSET_OTP_VAL*/
	{0x00004448,	0,	8}, /*VP_SARADC_OFFSET*/
	{0x00004448,	8,	8}, /*VP_GAIN_INDEX*/
	{0x00004448,	16,	8}, /*VBST_SARADC_OFFSET*/
	{0x00004448,	24,	8}, /*VBST_GAIN_INDEX*/
	{0x0000444C,	0,	3}, /*ANA_SELINVREF*/
	{0x00006E30,	0,	5}, /*GAIN_ERR_COEFF_0*/
	{0x00006E30,	8,	5}, /*GAIN_ERR_COEFF_1*/
	{0x00006E30,	16,	5}, /*GAIN_ERR_COEFF_2*/
	{0x00006E30,	24,	5}, /*GAIN_ERR_COEFF_3*/
	{0x00006E34,	0,	5}, /*GAIN_ERR_COEFF_4*/
	{0x00006E34,	8,	5}, /*GAIN_ERR_COEFF_5*/
	{0x00006E34,	16,	5}, /*GAIN_ERR_COEFF_6*/
	{0x00006E34,	24,	5}, /*GAIN_ERR_COEFF_7*/
	{0x00006E38,	0,	5}, /*GAIN_ERR_COEFF_8*/
	{0x00006E38,	8,	5}, /*GAIN_ERR_COEFF_9*/
	{0x00006E38,	16,	5}, /*GAIN_ERR_COEFF_10*/
	{0x00006E38,	24,	5}, /*GAIN_ERR_COEFF_11*/
	{0x00006E3C,	0,	5}, /*GAIN_ERR_COEFF_12*/
	{0x00006E3C,	8,	5}, /*GAIN_ERR_COEFF_13*/
	{0x00006E3C,	16,	5}, /*GAIN_ERR_COEFF_14*/
	{0x00006E3C,	24,	5}, /*GAIN_ERR_COEFF_15*/
	{0x00006E40,	0,	5}, /*GAIN_ERR_COEFF_16*/
	{0x00006E40,	8,	5}, /*GAIN_ERR_COEFF_17*/
	{0x00006E40,	16,	5}, /*GAIN_ERR_COEFF_18*/
	{0x00006E40,	24,	5}, /*GAIN_ERR_COEFF_19*/
	{0x00006E44,	0,	5}, /*GAIN_ERR_COEFF_20*/
	{0x00006E48,	0,	10}, /*VOFF_GAIN_0*/
	{0x00006E48,	10,	10}, /*VOFF_GAIN_1*/
	{0x00006E48,	20,	10}, /*VOFF_GAIN_2*/
	{0x00006E4C,	0,	10}, /*VOFF_GAIN_3*/
	{0x00006E4C,	10,	10}, /*VOFF_GAIN_4*/
	{0x00006E4C,	20,	10}, /*VOFF_GAIN_5*/
	{0x00006E50,	0,	10}, /*VOFF_GAIN_6*/
	{0x00006E50,	10,	10}, /*VOFF_GAIN_7*/
	{0x00006E50,	20,	10}, /*VOFF_GAIN_8*/
	{0x00006E54,	0,	10}, /*VOFF_GAIN_9*/
	{0x00006E54,	10,	10}, /*VOFF_GAIN_10*/
	{0x00006E54,	20,	10}, /*VOFF_GAIN_11*/
	{0x00006E58,	0,	10}, /*VOFF_GAIN_12*/
	{0x00006E58,	10,	10}, /*VOFF_GAIN_13*/
	{0x00006E58,	20,	10}, /*VOFF_GAIN_14*/
	{0x00006E5C,	0,	10}, /*VOFF_GAIN_15*/
	{0x00006E5C,	10,	10}, /*VOFF_GAIN_16*/
	{0x00006E5C,	20,	10}, /*VOFF_GAIN_17*/
	{0x00006E60,	0,	10}, /*VOFF_GAIN_18*/
	{0x00006E60,	10,	10}, /*VOFF_GAIN_19*/
	{0x00006E60,	20,	10}, /*VOFF_GAIN_20*/
	{0x00006E64,	0,	10}, /*VOFF_INT1*/
	{0x00007418,	7,	5}, /*DS_SPK_INT1_CAP_TRIM*/
	{0x0000741C,	0,	5}, /*DS_SPK_INT2_CAP_TRIM*/
	{0x0000741C,	11,	4}, /*DS_SPK_LPF_CAP_TRIM*/
	{0x0000741C,	19,	4}, /*DS_SPK_QUAN_CAP_TRIM*/
	{0x00007434,	17,	1}, /*FORCE_CAL*/
	{0x00007434,	18,	7}, /*CAL_OVERRIDE*/
	{0x00007068,	0,	9}, /*MODIX*/
	{0x0000410C,	7,	1}, /*VIMON_DLY_NOT_COMB*/
	{0x0000400C,	0,	7}, /*VIMON_DLY*/
	{0x00004000,	11,	1}, /*VMON_POL*/
	{0x00017040,	0,	8}, /*X_COORDINATE*/
	{0x00017040,	8,	8}, /*Y_COORDINATE*/
	{0x00017040,	16,	8}, /*WAFER_ID*/
	{0x00017040,	24,	8}, /*DVS*/
	{0x00017044,	0,	24}, /*LOT_NUMBER*/
};

static const struct cs40l2x_trim cs40l2x_trim_table_e[] = {
	/* addr         shift   size */
	{0x00002030,	0,	4}, /*TRIM_OSC_FREQ_TRIM*/
	{0x00002030,	7,	1}, /*TRIM_OSC_TRIM_DONE*/
	{0x0000208C,	24,	6}, /*TST_DIGREG_VREF_TRIM*/
	{0x00002090,	14,	4}, /*TST_REF_TRIM*/
	{0x00002090,	10,	4}, /*TST_REF_TEMPCO_TRIM*/
	{0x0000300C,	11,	4}, /*PLL_LDOA_TST_VREF_TRIM*/
	{0x0000394C,	23,	2}, /*BST_ATEST_CM_VOFF*/
	{0x00003950,	0,	7}, /*BST_ATRIM_IADC_OFFSET*/
	{0x00003950,	8,	7}, /*BST_ATRIM_IADC_GAIN1*/
	{0x00003950,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET1*/
	{0x00003950,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN1*/
	{0x00003954,	0,	7}, /*BST_ATRIM_IADC_OFFSET2*/
	{0x00003954,	8,	7}, /*BST_ATRIM_IADC_GAIN2*/
	{0x00003954,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET2*/
	{0x00003954,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN2*/
	{0x00003958,	0,	7}, /*BST_ATRIM_IADC_OFFSET3*/
	{0x00003958,	8,	7}, /*BST_ATRIM_IADC_GAIN3*/
	{0x00003958,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET3*/
	{0x00003958,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN3*/
	{0x0000395C,	0,	7}, /*BST_ATRIM_IADC_OFFSET4*/
	{0x0000395C,	8,	7}, /*BST_ATRIM_IADC_GAIN4*/
	{0x0000395C,	16,	8}, /*BST_ATRIM_IPKCOMP_OFFSET4*/
	{0x0000395C,	24,	8}, /*BST_ATRIM_IPKCOMP_GAIN4*/
	{0x0000416C,	0,	8}, /*VMON_GAIN_OTP_VAL*/
	{0x00004160,	0,	7}, /*VMON_OFFSET_OTP_VAL*/
	{0x0000416C,	8,	8}, /*IMON_GAIN_OTP_VAL*/
	{0x00004160,	16,	10}, /*IMON_OFFSET_OTP_VAL*/
	{0x0000416C,	16,	12}, /*VMON_CM_GAIN_OTP_VAL*/
	{0x0000416C,	28,	1}, /*VMON_CM_GAIN_SIGN_OTP_VAL*/
	{0x00004170,	0,	6}, /*IMON_CAL_TEMPCO_OTP_VAL*/
	{0x00004170,	6,	1}, /*IMON_CAL_TEMPCO_SIGN_OTP*/
	{0x00004170,	8,	6}, /*IMON_CAL_TEMPCO2_OTP_VAL*/
	{0x00004170,	14,	1}, /*IMON_CAL_TEMPCO2_DN_UPB_OTP_VAL*/
	{0x00004170,	16,	9}, /*IMON_CAL_TEMPCO_TBASE_OTP_VAL*/
	{0x00004360,	0,	5}, /*TEMP_GAIN_OTP_VAL*/
	{0x00004360,	6,	9}, /*TEMP_OFFSET_OTP_VAL*/
	{0x00004448,	0,	8}, /*VP_SARADC_OFFSET*/
	{0x00004448,	8,	8}, /*VP_GAIN_INDEX*/
	{0x00004448,	16,	8}, /*VBST_SARADC_OFFSET*/
	{0x00004448,	24,	8}, /*VBST_GAIN_INDEX*/
	{0x0000444C,	0,	3}, /*ANA_SELINVREF*/
	{0x00006E30,	0,	5}, /*GAIN_ERR_COEFF_0*/
	{0x00006E30,	8,	5}, /*GAIN_ERR_COEFF_1*/
	{0x00006E30,	16,	5}, /*GAIN_ERR_COEFF_2*/
	{0x00006E30,	24,	5}, /*GAIN_ERR_COEFF_3*/
	{0x00006E34,	0,	5}, /*GAIN_ERR_COEFF_4*/
	{0x00006E34,	8,	5}, /*GAIN_ERR_COEFF_5*/
	{0x00006E34,	16,	5}, /*GAIN_ERR_COEFF_6*/
	{0x00006E34,	24,	5}, /*GAIN_ERR_COEFF_7*/
	{0x00006E38,	0,	5}, /*GAIN_ERR_COEFF_8*/
	{0x00006E38,	8,	5}, /*GAIN_ERR_COEFF_9*/
	{0x00006E38,	16,	5}, /*GAIN_ERR_COEFF_10*/
	{0x00006E38,	24,	5}, /*GAIN_ERR_COEFF_11*/
	{0x00006E3C,	0,	5}, /*GAIN_ERR_COEFF_12*/
	{0x00006E3C,	8,	5}, /*GAIN_ERR_COEFF_13*/
	{0x00006E3C,	16,	5}, /*GAIN_ERR_COEFF_14*/
	{0x00006E3C,	24,	5}, /*GAIN_ERR_COEFF_15*/
	{0x00006E40,	0,	5}, /*GAIN_ERR_COEFF_16*/
	{0x00006E40,	8,	5}, /*GAIN_ERR_COEFF_17*/
	{0x00006E40,	16,	5}, /*GAIN_ERR_COEFF_18*/
	{0x00006E40,	24,	5}, /*GAIN_ERR_COEFF_19*/
	{0x00006E44,	0,	5}, /*GAIN_ERR_COEFF_20*/
	{0x00006E48,	0,	10}, /*VOFF_GAIN_0*/
	{0x00006E48,	10,	10}, /*VOFF_GAIN_1*/
	{0x00006E48,	20,	10}, /*VOFF_GAIN_2*/
	{0x00006E4C,	0,	10}, /*VOFF_GAIN_3*/
	{0x00006E4C,	10,	10}, /*VOFF_GAIN_4*/
	{0x00006E4C,	20,	10}, /*VOFF_GAIN_5*/
	{0x00006E50,	0,	10}, /*VOFF_GAIN_6*/
	{0x00006E50,	10,	10}, /*VOFF_GAIN_7*/
	{0x00006E50,	20,	10}, /*VOFF_GAIN_8*/
	{0x00006E54,	0,	10}, /*VOFF_GAIN_9*/
	{0x00006E54,	10,	10}, /*VOFF_GAIN_10*/
	{0x00006E54,	20,	10}, /*VOFF_GAIN_11*/
	{0x00006E58,	0,	10}, /*VOFF_GAIN_12*/
	{0x00006E58,	10,	10}, /*VOFF_GAIN_13*/
	{0x00006E58,	20,	10}, /*VOFF_GAIN_14*/
	{0x00006E5C,	0,	10}, /*VOFF_GAIN_15*/
	{0x00006E5C,	10,	10}, /*VOFF_GAIN_16*/
	{0x00006E5C,	20,	10}, /*VOFF_GAIN_17*/
	{0x00006E60,	0,	10}, /*VOFF_GAIN_18*/
	{0x00006E60,	10,	10}, /*VOFF_GAIN_19*/
	{0x00006E60,	20,	10}, /*VOFF_GAIN_20*/
	{0x00006E64,	0,	10}, /*VOFF_INT1*/
	{0x00007418,	7,	5}, /*DS_SPK_INT1_CAP_TRIM*/
	{0x0000741C,	0,	5}, /*DS_SPK_INT2_CAP_TRIM*/
	{0x0000741C,	11,	4}, /*DS_SPK_LPF_CAP_TRIM*/
	{0x0000741C,	19,	4}, /*DS_SPK_QUAN_CAP_TRIM*/
	{0x00007434,	17,	1}, /*FORCE_CAL*/
	{0x00007434,	18,	7}, /*CAL_OVERRIDE*/
	{0x00007068,	0,	9}, /*MODIX*/
	{0x0000410C,	7,	1}, /*VIMON_DLY_NOT_COMB*/
	{0x0000400C,	0,	7}, /*VIMON_DLY*/
	{0x00004000,	11,	1}, /*VMON_POL*/
	{0x00017040,	0,	8}, /*X_COORDINATE*/
	{0x00017040,	8,	8}, /*Y_COORDINATE*/
	{0x00017040,	16,	8}, /*WAFER_ID*/
	{0x00017040,	24,	8}, /*DVS*/
	{0x00017044,	0,	24}, /*LOT_NUMBER*/
	{0x00003010,	2,	6}, /*PLL_DCO_CAL_TRIM*/
};

const struct cs40l2x_otp_desc cs40l2x_otp_map[CS40L2X_NUM_OTP_MAPS] = {
	{
		.id = 0xC,
		.row_start = 2,
		.col_start = 16,
		.num_trims = ARRAY_SIZE(cs40l2x_trim_table_c),
		.trim_table = cs40l2x_trim_table_c,
	},
	{
		.id = 0xD,
		.row_start = 2,
		.col_start = 16,
		.num_trims = ARRAY_SIZE(cs40l2x_trim_table_d),
		.trim_table = cs40l2x_trim_table_d,
	},
	{
		.id = 0xE,
		.row_start = 2,
		.col_start = 16,
		.num_trims = ARRAY_SIZE(cs40l2x_trim_table_e),
		.trim_table = cs40l2x_trim_table_e,
	},
};

const unsigned int cs40l2x_pbq_dig_scale[CS40L2X_PBQ_SCALE_MAX + 1] = {
	0,
	320,	/* 1% */
	272,
	244,
	224,
	208,
	195,
	185,
	176,
	167,
	160,	/* 10% */
	153,
	147,
	142,
	137,
	132,
	127,
	123,
	119,
	115,
	112,	/* 20% */
	108,
	105,
	102,
	99,
	96,
	94,
	91,
	88,
	86,
	84,	/* 30% */
	81,
	79,
	77,
	75,
	73,
	71,
	69,
	67,
	65,
	64,	/* 40% */
	62,
	60,
	59,
	57,
	55,
	54,
	52,
	51,
	50,
	48,	/* 50% */
	47,
	45,
	44,
	43,
	42,
	40,
	39,
	38,
	37,
	35,	/* 60% */
	34,
	33,
	32,
	31,
	30,
	29,
	28,
	27,
	26,
	25,	/* 70% */
	24,
	23,
	22,
	21,
	20,
	19,
	18,
	17,
	16,
	16,	/* 80% */
	15,
	14,
	13,
	12,
	11,
	10,
	10,
	9,
	8,
	7,	/* 90% */
	7,
	6,
	5,
	4,
	4,
	3,
	2,
	1,
	1,
	0,	/* 100% */
};

static const char * const cs40l2x_coeff_files_orig[] = {
	CS40L2X_WT_FILE_NAME_DEFAULT,
	CS40L2X_DYN_F0_FILE_NAME,
};

static const char * const cs40l2x_coeff_files_remap[] = {
	CS40L2X_WT_FILE_NAME_DEFAULT,
	"cs40l25a_exc.bin",
	CS40L2X_DYN_F0_FILE_NAME,
};

static const char * const cs40l2x_coeff_files_cal[] = {
	"cs40l25a_cal.bin",
};  /* Calibration */

static const char * const cs40l2x_coeff_files_clab[] = {
	CS40L2X_WT_FILE_NAME_DEFAULT,
	CS40L2X_CLAB_CONFIG_FILE_NAME,
};  /* Closed loop active braking */

static const char * const cs40l2x_coeff_files_par[] = {
	CS40L2X_WT_FILE_NAME_DEFAULT,
	CS40L2X_PAR_CONFIG_FILE_NAME,
};  /* PWLE Amplitude Regulation */

static const char * const cs40l2x_coeff_files_a2h[] = {
	CS40L2X_WT_FILE_NAME_DEFAULT,
	"cs40l25a_a2h.bin",
	CS40L2X_DYN_F0_FILE_NAME,
};  /* Audio to Haptics */

static const char * const cs40l2x_coeff_files_df0_clab[] = {
	CS40L2X_WT_FILE_NAME_DEFAULT,
	CS40L2X_DYN_F0_FILE_NAME,
	CS40L2X_CLAB_CONFIG_FILE_NAME,
};  /* Dynamic F0 and CLAB includes dynamic ReDC */

const struct cs40l2x_fw_desc cs40l2x_fw_fam[CS40L2X_NUM_FW_FAMS] = {
	{
		.id = CS40L2X_FW_ID_ORIG,
		.min_rev = 0x050102,
		.halo_state_started = 1,
		.halo_state_run = 2,
		.num_coeff_files = ARRAY_SIZE(cs40l2x_coeff_files_orig),
		.coeff_files = cs40l2x_coeff_files_orig,
		.fw_file = "cs40l20.wmfw",
	},
	{
		.id = CS40L2X_FW_ID_B1ROM,
		.min_rev = 0x010002,
		.halo_state_started = 1,
		.halo_state_run = 2,
		.num_coeff_files = 0,
		.coeff_files = NULL,
		.fw_file = NULL,
	},
	{
		.id = CS40L2X_FW_ID_REMAP,
		.min_rev = 0x080100,
		.halo_state_started = 202,
		.halo_state_run = 203,
		.num_coeff_files = ARRAY_SIZE(cs40l2x_coeff_files_remap),
		.coeff_files = cs40l2x_coeff_files_remap,
		.fw_file = "cs40l25a.wmfw",
	},
	{
		.id = CS40L2X_FW_ID_CAL,
		.min_rev = 0x080100,
		.halo_state_started = 202,
		.halo_state_run = 203,
		.num_coeff_files = ARRAY_SIZE(cs40l2x_coeff_files_cal),
		.coeff_files = cs40l2x_coeff_files_cal,
		.fw_file = "cs40l25a_cal.wmfw",
	},  /* Calibration */
	{
		.id = CS40L2X_FW_ID_CLAB,
		.min_rev = 0x080100,
		.halo_state_started = 202,
		.halo_state_run = 203,
		.num_coeff_files = ARRAY_SIZE(cs40l2x_coeff_files_clab),
		.coeff_files = cs40l2x_coeff_files_clab,
		.fw_file = "cs40l25a_clab.wmfw",
	},  /* Closed loop active braking */
	{
		.id = CS40L2X_FW_ID_PAR,
		.min_rev = 0x080A00,
		.halo_state_started = 202,
		.halo_state_run = 203,
		.num_coeff_files = ARRAY_SIZE(cs40l2x_coeff_files_par),
		.coeff_files = cs40l2x_coeff_files_par,
		.fw_file = "cs40l25a_par.wmfw",
	},  /* PWLE Amplitude Regulation */
	{
		.id = CS40L2X_FW_ID_A2H,
		.min_rev = 0x080A05,
		.halo_state_started = 202,
		.halo_state_run = 203,
		.num_coeff_files = ARRAY_SIZE(cs40l2x_coeff_files_a2h),
		.coeff_files = cs40l2x_coeff_files_a2h,
		.fw_file = "cs40l25a_a2h.wmfw",
	},  /* Audio to Haptics */
	{
		.id = CS40L2X_FW_ID_DF0_CLAB,
		.min_rev = 0x0A0303,
		.halo_state_started = 202,
		.halo_state_run = 203,
		.num_coeff_files = ARRAY_SIZE(cs40l2x_coeff_files_df0_clab),
		.coeff_files = cs40l2x_coeff_files_df0_clab,
		.fw_file = "cs40l25a_df0_clab.wmfw",
		/* Dynamic F0 and CLAB includes dynamic ReDC */
	},
};

const struct cs40l2x_hw_err_desc cs40l2x_hw_errs[CS40L2X_NUM_HW_ERRS] = {
	{
		.irq_mask = CS40L2X_AMP_ERR,
		.rls_mask = CS40L2X_AMP_ERR_RLS,
		.bst_cycle = false,
		.err_name = "amplifier short",
	},
	{
		.irq_mask = CS40L2X_TEMP_ERR,
		.rls_mask = CS40L2X_TEMP_ERR_RLS,
		.bst_cycle = false,
		.err_name = "overtemperature",
	},
	{
		.irq_mask = CS40L2X_TEMP_RISE_WARN,
		.rls_mask = CS40L2X_TEMP_RISE_WARN_RLS,
		.bst_cycle = false,
		.err_name = "temperature rise",
	},
	{
		.irq_mask = CS40L2X_BST_SHORT_ERR,
		.rls_mask = CS40L2X_BST_SHORT_ERR_RLS,
		.bst_cycle = true,
		.err_name = "boost converter short",
	},
	{
		.irq_mask = CS40L2X_BST_UVP_ERR,
		.rls_mask = CS40L2X_BST_UVP_ERR_RLS,
		.bst_cycle = true,
		.err_name = "boost converter undervoltage",
	},
	{
		.irq_mask = CS40L2X_BST_OVP_ERR,
		.rls_mask = CS40L2X_BST_OVP_ERR_RLS,
		.bst_cycle = true,
		.err_name = "boost converter overvoltage",
	},
};
